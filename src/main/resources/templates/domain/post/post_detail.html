<html layout:decorate="~{layout}" xmlns="http://www.w3.org/1999/html">
<div layout:fragment="content" class="container my-3 flex justify-content-center">
<div class="flex-column" style="width: 700px;">
<!-- post 제목-->
    <div class="fs-1" th:text="${post.subject}"></div>
    <div class="d-flex justify-content-between align-items-center">
        <div>
        <span class="fs-4 mr-3 text-gray-500" th:if="${post.author != null}" th:text="${post.author.membername}"></span>
        <span class="text-gray-300" th:text="${#temporals.format(post.createDate, 'yyyy년 MM월 dd일 HH:mm')}"></span>
        </div>
        <div id="counter-container" style="height: 60px" class="bg-transparent">
            <button class="bg-transparent" id="toggle-button">
                <span><i id="heart-icon" class="fa-solid fa-heart mr-1"></i></span>
                <span id="counter" class="fs-5">0</span>
            </button>
        </div>
    </div>
    <div class="flex justify-content-end">
        <div class="click mr-2 text-gray-400 hover:text-black">
            <a th:href="@{|/post/modify/${post.id}|}" sec:authorize="isAuthenticated()"
               th:if="${post.author != null and #authentication.getPrincipal().getUsername() == post.author.membername}">
                수정
            </a>
        </div>
        <div class="click text-gray-400 hover:text-black">
            <a th:href="@{|/post/delete/${post.id}|}" sec:authorize="isAuthenticated()"
               th:if="${post.author != null and #authentication.getPrincipal().getUsername() == post.author.membername}">
                삭제
            </a>
        </div>
    </div>
<!-- post 내용-->
    <div class="fs-5 border-top border-bottom border-dark mt-3 mb-3 pt-3 pb-3" style="min-height: 250px; height: fit-content;" th:text="${post.content}"></div>
<!-- 답변 수-->
    <div class="text-red-500 mt-4 mb-4">
        <h5 th:if="${#lists.size(post.commentList)} == 0">댓글이 없습니다.</h5>
        <h5 th:if="${#lists.size(post.commentList)} > 0" th:text="|${#lists.size(post.commentList)}개의 댓글이 있습니다.|"></h5>
    </div>
<!--답변리스트-->
<div th:if="${#lists.size(post.commentList)} != 0" th:each="comment : ${post.commentList}"
     class="border rounded mb-4 p-1 border-primary bg-blue-50">
    <div class="d-flex justify-content-between align-items-center" style="height: 60px">
        <div>
            <span class="fs-4 mr-3 text-blue-400" th:if="${comment.author != null}" th:text="${comment.author.membername}"></span>
            <span class="text-gray-400" th:text="${#temporals.format(post.createDate, 'yyyy년 MM월 dd일 HH:mm')}"></span>
        </div>
        <div id="counter-container" class="flex align-items-center bg-transparent">
            <button id="toggle-button" class="bg-transparent">
                <span><i id="heart-icon" class="fa-solid fa-heart mr-1"></i></span>
                <span id="counter" class="fs-5">0</span>
            </button>
        </div>
    </div>
    <div class="flex justify-content-end">
        <div class="fs-5 flex-grow-1">
            <ul>
                <li th:text="${comment.content}"></li>
            </ul>
        </div>
        <div class="click mr-2 text-gray-400 hover:text-black">
            <a th:href="@{|/comment/modify/${comment.id}|}" sec:authorize="isAuthenticated()"
               th:if="${comment.author != null and #authentication.getPrincipal().getUsername() == comment.author.membername}">
                수정
            </a>
        </div>
        <div class="click text-gray-400 hover:text-black">
            <a th:href="@{|/comment/delete/${comment.id}|}" sec:authorize="isAuthenticated()"
               th:if="${comment.author != null and #authentication.getPrincipal().getUsername() == comment.author.membername}">
                삭제
            </a>
        </div>
    </div>
</div>

<!--답변작성-->
    <form th:action="@{|/comment/create/${post.id}|}" method="post" th:object="${commentForm}">
        <div th:replace="~{form_errors :: formErrorsFragment}"></div>
        <div class="flex-column" >
        <span><textarea placeholder="댓글을 입력하세요" class="bg-gray-100 rounded-2" style="width: 700px; min-height:200px; " th:field="*{content}" name="content" id="content"></textarea></span>
        <span class="flex justify-content-end"><input type="submit" value="댓글등록"></span>
        </div>
    </form>
</div>
</div>
</html>